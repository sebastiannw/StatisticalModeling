knitr::opts_chunk$set(echo = TRUE)
library(arm)
library(pROC)
library(e1071)
library(caret)
library(knitr)
library(ggplot2)
library(rms)
rb <- c('red', 'orange', 'yellow', 'green', 'blue', 'purple')
kable(matrix(c('(intercept)', 're74_c', 'educ_c', 'age_c', 'treat', 'married', '5744.1241*', -0.0548, 341.6613, 57.5549, 801.4035, 1106.5340), nrow = 6, ncol = 2), col.names = c('Variable', 're_78 Slope at Baseline'), caption = 're_78 Slopes at Baseline')
mean(wages$re74)
wages <- read.csv('lalondedata.csv', na.strings = "NA")
wages <- wages[, c('treat', 'age', 'educ', 'black', 'hispan', 'married', 'nodegree',
're74', 're75', 're78')]
wages$re78_sqrt <- sqrt(wages$re78)
wages$age_c <- wages$age - mean(wages$age)
wages$educ_c <- wages$educ - mean(wages$educ)
wages$re74_c <- wages$re74 - mean(wages$re74)
wages <- wages[wages$re78 != 0,]
mean(wages$re74)
mean(wages$re78)
knitr::opts_chunk$set(echo = TRUE)
library(arm)
library(pROC)
library(e1071)
library(caret)
library(knitr)
library(ggplot2)
library(rms)
rb <- c('red', 'orange', 'yellow', 'green', 'blue', 'purple')
wages <- read.csv('lalondedata.csv', na.strings = "NA")
wages <- wages[, c('treat', 'age', 'educ', 'black', 'hispan', 'married', 'nodegree',
're74', 're75', 're78')]
wages$re78_sqrt <- sqrt(wages$re78)
wages$age_c <- wages$age - mean(wages$age)
wages$educ_c <- wages$educ - mean(wages$educ)
wages$re74_c <- wages$re74 - mean(wages$re74)
wages <- wages[wages$re78 != 0,]
hist(wages$re78, xlab = "re78", main = "Distribution of re78",
col = rb, breaks = 20)
hist(log(wages$re78 + 1), xlab = "log(re78)", main = "Distribution of log(re78)",
col = rb, breaks = 20)
hist(wages$re78_sqrt, xlab = "sqrt(re78)", main = "Distribution of sqrt(re78)",
col = rb, breaks = 20)
lm_wages0 <- lm(formula = re78_sqrt ~ re74 + educ + age + married + re74:age + re74:married, data = wages)
lm_wages1 <- lm(formula = re78_sqrt ~ re74_c + educ_c + age_c + married + re74_c:age_c + re74_c:married, data = wages)
vif_table <- cbind(data.frame(vif(lm_wages0)), data.frame(vif(lm_wages1)))
colnames(vif_table) = c('VIF without Centering', 'VIF for Centered Data')
kable(vif_table, caption = 'VIF Values for Both Models')
#n <- nrow(wages)
null_model <- lm(re78_sqrt ~ 1, data = wages)
full_model <- lm(re78_sqrt ~ treat * age_c * educ_c * black * hispan * married * nodegree * re74_c,
data = wages)
#model_forward <- step(null_model, scope = formula(full_model),
#direction = 'forward', trace = 0)
#model_forward2 <- step(null_model, scope = formula(full_model),
#direction = 'forward', trace = 0, k = log(n))
#summary(model_forward)
#summary(model_forward2)
#confint(model_forward, level = 0.95)
#model_backward <- step(full_model, direction = 'backward', trace = 0)
#model_backward2 <- step(full_model, direction = 'backward', trace = 0, k = log(n))
#summary(model_backward)
#summary(model_backward2)
model_stepwise <- step(null_model, scope = formula(full_model),
direction = 'both', trace = 0)
#model_stepwise2 <- step(null_model, scope = formula(full_model),
#direction = 'both', trace = 0, k = log(n))
#summary(model_stepwise)
#summary(model_stepwise2)
#lm_wages <- lm(formula = re78_sqrt ~ re74 + educ + age + married + re74:age + re74:married, data = wages)
#summary(lm_wages)
#vif(lm_wages)
lm_wages <- lm(formula = re78_sqrt ~ re74_c + educ_c + age_c + treat + married + re74_c:age_c + re74_c:married, data = wages)
#summary(lm_wages)
#confint.default(lm_wages)
kable(anova(model_stepwise, lm_wages), caption = 'F-Test Results')
#vif(lm_wages)
kable(vif(lm_wages), col.names	= c('VIF'), caption = 'VIFs for Final Model')
kable(matrix(c('(intercept)', 're74_c', 'educ_c', 'age_c', 'treat', 'married', '5744.1241*', -0.0548, 341.6613, 57.5549, 801.4035, 1106.5340), nrow = 6, ncol = 2), col.names = c('Variable', 're_78 Slope at Baseline'), caption = 're_78 Slopes at Baseline')
boxplot(re78_sqrt ~ treat, data = wages, ylab = 'sqrt(re78)',
xlab = 'treat', col = rainbow(15))
plot(wages$re78_sqrt ~ wages$age, xlab = 'age', ylab = 'sqrt(re78)', col = 'cyan4')
abline(lm(re78_sqrt ~ age, data = wages), col = 'red3', lty = 10, lwd = 2)
plot(wages$re78_sqrt ~ wages$educ, xlab = 'educ', ylab = 'sqrt(re78)', col = 'cyan4')
abline(lm(re78_sqrt ~ educ, data = wages), col = 'red3', lty = 10, lwd = 2)
boxplot(re78_sqrt ~ black, data = wages, ylab = 'sqrt(re78)',
xlab = 'black', col = rainbow(15))
boxplot(re78_sqrt ~ hispan, data = wages, ylab = 'sqrt(re78)',
xlab = 'hispan', col = rainbow(15))
boxplot(re78_sqrt ~ married, data = wages, ylab = 'sqrt(re78)',
xlab = 'married', col = rainbow(15))
boxplot(re78_sqrt ~ nodegree, data = wages, ylab = 'sqrt(re78)',
xlab = 'nodegree', col = rainbow(15))
plot(wages$re78_sqrt ~ wages$re74, xlab = 're74', ylab = 'sqrt(re78)', col = 'cyan4')
abline(lm(re78_sqrt ~ re74, data = wages), col = 'gold', lty = 10, lwd = 2)
plot(y = lm_wages$residual, x = wages$re74, xlab = "re74", ylab = "Residual", col = 'red3', main = "re74 vs. Residual")
abline(0,0)
plot(y = lm_wages$residual, x = wages$educ, xlab = "educ", ylab = "Residual", col = 'lightblue', main = "educ vs. Residual")
abline(0,0)
plot(y = lm_wages$residual, x = wages$age, xlab = "age", ylab = "Residual", col = 'green3', main = "age vs. Residual")
abline(0,0)
plot(y = lm_wages$residual, x = wages$treat, xlab = "treat", ylab = "Residual", col = 'gold', main = "treat vs. Residual")
abline(0,0)
plot(y = lm_wages$residual, x = wages$married, xlab = "married", ylab = "Residual", col = 'red3', main = "married vs. Residual")
abline(0,0)
plot(lm_wages, which = 1, col = 'orange')
plot(lm_wages, which = 2, col = 'darkblue')
lm_wages <- lm(formula = re78_sqrt ~ re74 + educ + age + treat + married + re74:age
+ re74:married, data = wages)
summary(lm_wages)
lm_wages <- lm(formula = re78_sqrt ~ re74_c + educ_c + age_c + treat + married
+ re74_c:age_c + re74_c:married, data = wages)
summary(lm_wages)
confint.default(lm_wages)
predict(lm_wages)
wages$re78_sqrt
?predict
data.frame(re74_c = 0, educ_c = 0, age_c = 0, treat = 0, married = 0)
d <- data.frame(re74_c = 0, educ_c = 0, age_c = 0, treat = 0, married = 0)
predict(lm_wages, d)
d <- data.frame(re74_c = 6, educ_c = 8, age_c = 10, treat = 1, married = 1)
predict(lm_wages, d)
d <- data.frame(re74_c = 76567567, educ_c = -8768, age_c = 876876, treat = 1, married = 1)
predict(lm_wages, d)
